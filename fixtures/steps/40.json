{ "name" : "array_test_async", "version" : "1.0", "author" : "Qore Technologies, sro", "steptype" : "ASYNC", "stepfunction_instanceid" : 57, "validationfunction_instanceid" : 63, "endfunction_instanceid" : 72, "arrayfunction_instanceid" : 50, "arraytype" : "SERIES", "queueid" : 1, "created" : "2012-12-16 17:06:15.000000 +01:00", "stepid" : 40, "typedesc" : "ASYNC ARRAY", "functions" : [ { "type" : "primary", "name" : "array_test_async", "version" : "1.0", "function_instanceid" : 57, "function_type" : "ASYNC-START", "description" : "async test function", "author" : "Qore Technologies, sro", "body" : "sub array_test_async($element) {\n    log(LL_INFO, \"element = %n\", $element);\n\n    setCustomStatus(\"Q\");\n\n    # 10% chance of an error\n    if (getOption(\"fast-exec\") || getOption(\"skip-async\") || !(rand() % 10))\n\tskipAsyncStep();\n    else if (!getOption(\"no-errors\") && !getOption(\"no-async-errors\") && !(rand() % 10))\n\tserror(\"ASYNC-ERROR\");\n    else {\n\tmy $key = sprintf(\"async-test-key-%s-%d\", \n\t\t\t  format_date(\"YYYY-MM-DD-HH:mm:SS\", now()), \n\t\t\t  (rand() % 10000));\n\t#log(LL_INFO, \"sending key: %s\", $key);\n\tsubmitAsyncKey($key);\n    }\n}\n", "created" : "2012-12-16 17:06:13.000000 +01:00", "modified" : "2014-10-06 09:41:36.000000 +02:00", "createdby" : "omq", "modifiedby" : "omq", "tags" : {  }, "source" : "/export/home/dnichols/src/Qorus/svn/trunk/test/TEST-WORKFLOWS/test-functions-v1.0.qfd", "offset" : "137", "host" : "manatee.prague.qoretechnologies.com", "user" : "<shell-unknown>" }, { "type" : "validation", "name" : "async_validation", "version" : "1.0", "function_instanceid" : 63, "function_type" : "VALIDATION", "description" : "asynchronous validation test function", "author" : "Qore Technologies, sro", "body" : "sub async_validation($arg) {\n    my $stat;\n    log(LL_INFO, \"key=%n\", $arg);\n    if (exists $arg)\n\t$stat = OMQ::StatComplete;\n    else\n\t$stat = OMQ::StatRetry;\n    log(LL_INFO, \"returning status: %n\", $stat);\n    return $stat;\n}\n", "created" : "2012-12-16 17:06:13.000000 +01:00", "modified" : "2014-10-06 09:41:36.000000 +02:00", "createdby" : "omq", "modifiedby" : "omq", "tags" : {  }, "source" : "/export/home/dnichols/src/Qorus/svn/trunk/test/TEST-WORKFLOWS/test-functions-v1.0.qfd", "offset" : "259", "host" : "manatee.prague.qoretechnologies.com", "user" : "<shell-unknown>" }, { "type" : "array", "name" : "array_test_array", "version" : "1.0", "function_instanceid" : 50, "function_type" : "ARRAY", "description" : "array function test", "author" : "Qore Technologies, sro", "body" : "sub array_test_array() {\n    if (getOption(\"fast-exec\"))\n\treturn True;\n\n    # 1 out of 10 times throw an error\n    if (!getOption(\"no-errors\")) {\n\tif (!(rand() % 10))\n\t    serror(\"TEST-ERROR\");\n\n\t# another chance: 1/10 return NOTHING\n\tif (!(rand() % 10))\n\t    return;\n    }\n\n    # otherwise get array from stepname\n    my $key = getStepInfo().name;\n    my $array = getDynamicData($key);\n    \n    if (!exists $array) {\n\tmy $r = (rand() % 10);\n\n\tfor (my $i; $i < $r; $i++)\n\t    $array[$i] = ( \"key1\" : rand() % 20,\n\t\t\t   \"key2\" : \"this is key2\",\n\t\t\t   \"index\" : $i );\n\tmy $h.$key = $array;\n\tupdateDynamicData($h);\n    }\n    return $array;\n}\n", "created" : "2012-12-16 17:06:13.000000 +01:00", "modified" : "2014-10-06 09:41:36.000000 +02:00", "createdby" : "omq", "modifiedby" : "omq", "tags" : {  }, "source" : "/export/home/dnichols/src/Qorus/svn/trunk/test/TEST-WORKFLOWS/test-functions-v1.0.qfd", "offset" : "35", "host" : "manatee.prague.qoretechnologies.com", "user" : "<shell-unknown>" }, { "type" : "async-end", "name" : "async_test_f1_end", "version" : "1.0", "function_instanceid" : 72, "function_type" : "ASYNC-END", "description" : "test async end function", "author" : "Qore Technologies, sro", "body" : "sub async_test_f1_end($data) {\n    #if ($data.status == \"ERROR\")\n\t#serror(\"ASYNC-RECEIVE-ERROR\");\n    log(LL_INFO, \"data=%n\", $data);\n}\n", "created" : "2012-12-16 17:06:13.000000 +01:00", "modified" : "2014-10-06 09:41:36.000000 +02:00", "createdby" : "omq", "modifiedby" : "omq", "tags" : {  }, "source" : "/export/home/dnichols/src/Qorus/svn/trunk/test/TEST-WORKFLOWS/test-functions-v1.0.qfd", "offset" : "508", "host" : "manatee.prague.qoretechnologies.com", "user" : "<shell-unknown>" } ], "description" : "async test function" }