<% var domains = obj.data %>

<div class="create">
  <a class="btn btn-small btn-success" data-toggle="modal" data-target="#prop-editor"><i class="icon-plus"></i> Add property</a>
</div>
<% _.each(domains, function (domain, key) { %>
  <h5><%= key %></h5>
  <table class="table table-striped table-condensed">
    <tbody>
  <% _.each(domain, function(prop, pkey) { %>
    <tr>
      <td class="property-key"><%= pkey %></td>
      <td class="property-value"><%= (_.isObject(prop)) ? JSON.stringify(prop) : prop %></td>
      <td class="property-actions"><a class="btn btn-small btn-warning edit-modal" data-toggle="modal" data-target="#prop-editor" 
          data-key="<%= pkey %>" data-value="<%= prop %>" data-domain="<%= key %>"><i class="icon-pencil"></i> Edit</a></td>
    </tr>
  <% }) %>
    </tbody>
  </table>
<% }) %>

<div id="prop-editor" class="modal hide fade wider" tabindex="-1" role="dialog" aria-labelledby="modalHeader" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="modalHeader">Create new property</h3>
  </div>
  <form>
  <div class="modal-body">
      <label for="domain">Domain</label>
      <input type="text" value="" name="domain" id="domain" />
      <label for="key">Key</label>
      <input type="text" value="" name="key" id="key" />
      <label for="value">Value</label>
      <textarea type="hidden" name="value" id="value"></textarea>
  </div>
  <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
        <button type="submit" class="btn btn-success" data-action="update">Save</button>
  </div>
  </form>
</div>

<script type="text/javascript" charset="utf-8">
// plugin showcase
$('.edit-modal').click(function (e) {
   var $target = $(e.currentTarget);
   $('#key').val($target.data('key'));
   $('#value').val($target.data('value'));
   $('#domain').val($target.data('domain'));
});
</script>